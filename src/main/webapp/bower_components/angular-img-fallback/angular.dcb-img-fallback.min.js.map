{"version":3,"sources":["angular.dcb-img-fallback.js"],"names":[],"mappings":";;AAMC,aAAY;AACT,YAAQ,MAAR,CAAe,gBAAf,EAAiC,EAAjC,EAEK,SAFL,CAEe,aAFf,EAE8B,CAAC,cAAD,EAAiB,wBAAgB;;AAEvD,eAAO;AACH,sBAAU,GADP;AAEH,kBAAM,cAAC,KAAD,EAAQ,OAAR,EAAiB,IAAjB,EAA0B;AAG5B,oBAAI,SAAS,KAAK,WAAL,GAAmB,aAAa,UAAb,CAAwB,KAAK,WAA7B,CAAnB,GAA+D,aAAa,UAAb,EAA5E;;AAGA,oBAAI,eAAe,SAAf,YAAe,GAAM;AAGrB,wBAAI,SAAS,KAAK,WAAL,GAAmB,aAAa,UAAb,CAAwB,KAAK,WAA7B,CAAnB,GAA+D,aAAa,UAAb,EAA5E;;AAEA,wBAAI,QAAQ,CAAR,EAAW,GAAX,KAAmB,MAAvB,EAA+B;AAC3B,gCAAQ,CAAR,EAAW,GAAX,GAAiB,MAAjB;AACH;AACJ,iBARD;;AAWA,oBAAI,QAAQ,CAAR,EAAW,GAAX,KAAmB,aAAa,UAAb,EAAvB,EAAkD;AAC9C,4BAAQ,CAAR,EAAW,GAAX,GAAiB,MAAjB;AACH;;AAED,wBAAQ,EAAR,CAAW,OAAX,EAAoB,YAApB;;AAEA,sBAAM,GAAN,CAAU,UAAV,EAAsB,YAAM;AACxB,4BAAQ,GAAR,CAAY,OAAZ,EAAqB,YAArB;AACH,iBAFD;AAIH;AA7BE,SAAP;AA+BH,KAjCyB,CAF9B,EAsCK,SAtCL,CAsCe,YAtCf,EAsC6B,CAAC,cAAD,EAAiB,cAAjB,EAAiC,UAAC,YAAD,EAAe,YAAf,EAAgC;AAGtF,YAAI,eAAe,SAAf,YAAe,CAAC,KAAD,EAAQ,OAAR,EAAiB,IAAjB,EAA0B;AAEzC,oBAAQ,CAAR,EAAW,GAAX,GAAiB,KAAK,UAAL,GAAkB,aAAa,UAAb,CAAwB,KAAK,UAA7B,CAAlB,GAA6D,aAAa,UAAb,EAA9E;;AAEA,gBAAI,MAAM,IAAI,KAAJ,EAAV;AACA,gBAAI,GAAJ,GAAU,aAAa,KAAK,MAAlB,EAA0B,KAA1B,CAAV;;AAEA,gBAAI,MAAJ,GAAa,YAAM;AACf,oBAAI,MAAJ,GAAa,IAAb;AACA,oBAAI,QAAQ,CAAR,EAAW,GAAX,KAAmB,IAAI,GAA3B,EAAgC;AAC5B,4BAAQ,CAAR,EAAW,GAAX,GAAiB,IAAI,GAArB;AACH;AACJ,aALD;AAMH,SAbD;;AAeA,eAAO;AACH,sBAAU,GADP;AAEH,qBAAS,iBAAC,EAAD,EAAK,IAAL,EAAc;AAEnB,qBAAK,MAAL,GAAc,KAAK,KAAnB;AACA,uBAAO,KAAK,KAAZ;;AAEA,uBAAO,YAAP;AACH;AARE,SAAP;AAUH,KA5BwB,CAtC7B,EAoEK,OApEL,CAoEa,cApEb,EAoE6B,YAAM;AAE3B,YAAI,eAAe,2qBAAnB;;AAEA,YAAI,iBAAoB,YAApB,smBAAJ;AACA,YAAI,iBAAoB,YAApB,kIAAJ;;AAEA,eAAO;AACH,wBAAY,sBAAM;AACd,uBAAO,cAAP;AACH,aAHE;AAIH,wBAAY,sBAAM;AACd,uBAAO,cAAP;AACH,aANE;AAOH,wBAAY,oBAAC,MAAD,EAAY;AACpB,uBAAO,iBAAiB,MAAxB;AACH,aATE;AAUH,wBAAY,oBAAC,MAAD,EAAY;AACpB,uBAAO,iBAAiB,MAAxB;AACH;AAZE,SAAP;AAcH,KAzFL;AA0FH,CA3FA,GAAD","file":"angular.dcb-img-fallback.min.js","sourcesContent":["/**\r\n * Angular Image Fallback\r\n * (c) 2014-2016 Daniel Cohen. http://dcb.co.il\r\n * License: MIT\r\n * https://github.com/dcohenb/angular-img-fallback\r\n */\r\n(function () {\r\n    angular.module('dcbImgFallback', [])\r\n\r\n        .directive('fallbackSrc', ['imageService', imageService => {\r\n\r\n            return {\r\n                restrict: 'A',\r\n                link: (scope, element, attr) => {\r\n\r\n                    // Update the service with the correct missing src if present, otherwise use the default image\r\n                    let newSrc = attr.fallbackSrc ? imageService.setMissing(attr.fallbackSrc) : imageService.getMissing();\r\n\r\n                    // Listen for errors on the element and if there are any replace the source with the fallback source\r\n                    let errorHandler = () => {\r\n\r\n                        // fallbackSrc may have changed since the link function ran, so try to grab it again.\r\n                        let newSrc = attr.fallbackSrc ? imageService.setMissing(attr.fallbackSrc) : imageService.getMissing();\r\n\r\n                        if (element[0].src !== newSrc) {\r\n                            element[0].src = newSrc;\r\n                        }\r\n                    };\r\n\r\n                    // Replace the loading image with missing image if `ng-src` link was broken\r\n                    if (element[0].src === imageService.getLoading()) {\r\n                        element[0].src = newSrc;\r\n                    }\r\n\r\n                    element.on('error', errorHandler);\r\n\r\n                    scope.$on('$destroy', () => {\r\n                        element.off('error', errorHandler);\r\n                    });\r\n\r\n                }\r\n            };\r\n        }])\r\n\r\n\r\n        .directive('loadingSrc', ['$interpolate', 'imageService', ($interpolate, imageService) => {\r\n\r\n            // Load the image source in the background and replace the element source once it's ready\r\n            let linkFunction = (scope, element, attr) => {\r\n                // Update the service with the correct loading src if present, otherwise use the default image\r\n                element[0].src = attr.loadingSrc ? imageService.setLoading(attr.loadingSrc) : imageService.getLoading();\r\n\r\n                let img = new Image();\r\n                img.src = $interpolate(attr.imgSrc)(scope);\r\n\r\n                img.onload = () => {\r\n                    img.onload = null;\r\n                    if (element[0].src !== img.src) {\r\n                        element[0].src = img.src;\r\n                    }\r\n                };\r\n            };\r\n\r\n            return {\r\n                restrict: 'A',\r\n                compile: (el, attr) => {\r\n                    // Take over the ng-src attribute to stop it from loading the image\r\n                    attr.imgSrc = attr.ngSrc;\r\n                    delete attr.ngSrc;\r\n\r\n                    return linkFunction;\r\n                }\r\n            };\r\n        }])\r\n\r\n        .factory('imageService', () => {\r\n            // Both images have the same prefix we can save some space on that\r\n            let base64prefix = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAwIDEwMDAiPjxkZWZzPjxyYWRpYWxHcmFkaWVudCBpZD0icmFkaWFsLWdyYWRpZW50IiBjeD0iNTAwIiBjeT0iNTAwIiByPSI1MDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNkZmRmZGYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5OTkiLz48L3JhZGlhbEdyYWRpZW50PjwvZGVmcz48cmVjdCBmaWxsPSJ1cmwoI3JhZGlhbC1ncmFkaWVudCkiIHdpZHRoPSIxMDAwIiBoZWlnaHQ9IjEwMDAiLz48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNjAxIDQxNGwwIDBWNTg2bDAgMEgzOTlsMCAwVjQxNGwwIDBINjAxWm0wLTE0SDM5OUExNCAxNCAwIDAgMCAzODUgNDE0djE3M2ExNCAxNCAwIDAgMCAxNCAxNEg2MDFBMTQgMTQgMCAwIDAgNjE1IDU4NlY0MTRhMTQgMTQgMCAwIDAtMTQtMTRoMFpNNTc';\r\n\r\n            let loadingDefault = `${base64prefix}1IDUwMmE3NyA3NyAwIDAgMC0yNC01NCA3NiA3NiAwIDAgMC0yNS0xNiA3NSA3NSAwIDAgMC01NyAxQTc0IDc0IDAgMCAwIDQzMCA0NzQgNzMgNzMgMCAwIDAgNDMxIDUzMGE3MiA3MiAwIDAgMCAzOSAzOCA3MCA3MCAwIDAgMCA1NC0xIDY5IDY5IDAgMCAwIDM3LTM4IDY4IDY4IDAgMCAwIDQtMTZsMSAwYTEwIDEwIDAgMCAwIDEwLTEwYzAgMCAwLTEgMC0xaDBabS0xNSAyNmE2NyA2NyAwIDAgMS0zNyAzNSA2NiA2NiAwIDAgMS01MC0xIDY0IDY0IDAgMCAxLTM0LTM1QTYzIDYzIDAgMCAxIDQ0MCA0NzkgNjIgNjIgMCAwIDEgNDU0IDQ1OSA2MiA2MiAwIDAgMSA0NzQgNDQ2YTYxIDYxIDAgMCAxIDIzLTQgNjAgNjAgMCAwIDEgNDIgMTlBNTkgNTkgMCAwIDEgNTUyIDQ4MGE1OCA1OCAwIDAgMSA0IDIyaDBjMCAwIDAgMSAwIDFhMTAgMTAgMCAwIDAgOSAxMCA2NyA2NyAwIDAgMS01IDE1aDBaIi8+PC9zdmc+`;\r\n            let missingDefault = `${base64prefix}yIDQ1MGEyMiAyMiAwIDEgMS0yMi0yMkEyMiAyMiAwIDAgMSA1NzIgNDUwWk01ODYgNTcySDQxNFY1NDNsNTAtODYgNTggNzJoMTRsNTAtNDN2ODZaIi8+PC9zdmc+`;\r\n\r\n            return {\r\n                getLoading: () => {\r\n                    return loadingDefault;\r\n                },\r\n                getMissing: () => {\r\n                    return missingDefault;\r\n                },\r\n                setLoading: (newSrc) => {\r\n                    return loadingDefault = newSrc;\r\n                },\r\n                setMissing: (newSrc) => {\r\n                    return missingDefault = newSrc;\r\n                }\r\n            };\r\n        });\r\n}());"]}